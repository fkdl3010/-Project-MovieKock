<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >


<mapper namespace="com.koreait.movie.dao.QnaDao">
		
	<insert id="qnaWrite" parameterType="com.koreait.movie.dto.QnaDto">
		INSERT INTO
		   QNA
	    <if test="qna_pw!=null">VALUES (QNA_SEQ.NEXTVAL, #{qna_select}, #{qna_title}, #{qna_secret}, #{user_no}, #{qna_content}, #{qna_pw}, SYSDATE, #{qna_yn})</if>
	    <if test="qna_pw==null">VALUES (QNA_SEQ.NEXTVAL, #{qna_select}, #{qna_title}, #{qna_secret}, #{user_no}, #{qna_content}, NULL, SYSDATE, #{qna_yn})</if>
	</insert>
	
	<select id="userNickname" parameterType="int" resultType="string"> 
		SELECT USER_NICKNAME 
		FROM USERS 
		WHERE USER_NO = #{user_no} 
	</select> 
	 
	
	<select id="qnaList" resultType="com.koreait.movie.dto.QnaDto">
		SELECT B.*
		  FROM (SELECT ROWNUM AS RN, A.*
		          FROM (SELECT *
		                  FROM QNA
		              ORDER BY USER_NO DESC) A ) B
		 WHERE B.RN BETWEEN #{param1} AND #{param2}
	</select>
	
	
	<select id="totalRecord" resultType="int">
		SELECT COUNT(*)
		  FROM QNA
	</select>
	
	<select id="qnaView" parameterType="int" resultType="com.koreait.movie.dto.QnaDto">
		SELECT *
		  FROM QNA
		 WHERE user_NO = #{user_no}
	</select>
	
	
	
</mapper>